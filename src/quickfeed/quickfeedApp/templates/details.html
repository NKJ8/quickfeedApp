{% extends 'base.html' %}

{% load static %}

{% block 'page-title' %}
    {{ title }}
{% endblock 'page-title' %}

{% block 'page-content' %}
    
    
    {% if searched %}
        {% comment %} <h1> Your Search Result For {{ searched }} </h1>
        <br/> {% endcomment %}
        {% for b in business %}
            
              <div class="container rounded bg-white mt-5 mb-5 d-flex flex-column">
                <div class="container">
                    <div class="card">
                        <div class="container-fliud">
                            <div class="wrapper row">
                                <div class="preview col-md-6">
                                    
                                    <div class="preview-pic tab-content">
                                    <div class="tab-pane active" id="pic-1"><img src="{{ b.image1.url }}" /></div>
                                    </div>
                                    <ul class="preview-thumbnail nav nav-tabs">
                                    <li class="active"><a data-target="#pic-1" data-toggle="tab"><img src="{{ b.image2.url }}" /></a></li>
                                    <li><a data-target="#pic-2" data-toggle="tab"><img src="{{ b.image3.url }}" /></a></li>
                                    <li><a data-target="#pic-3" data-toggle="tab"><img src="{{ b.image4.url }}" /></a></li>
                                    <li><a data-target="#pic-4" data-toggle="tab"><img src="{{ b.image5.url }}" /></a></li>
                                    <li><a data-target="#pic-5" data-toggle="tab"><img src="{{ b.image6.url }}" /></a></li>
                                    </ul>
                                    
                                </div>
                                <div class="details col-md-6">
                                    <h3 class="product-title">{{ b }}</h3>
                                    <div class="rating">
                                        <div class="stars">
                                            {% with  b.avg_rate|floatformat:0|add:0 as avgs %}
                                            {% if b.avg_rate == None %}
                                            N/A Average Rating
                                            {% else %}
                                            {% load my_filters %}
                                            {% for i in avgs|times %}
                                            <span class="fa fa-star"></span>
                                            {% endfor %} 
                                            </br>
                                            Average Rating
                                            {% comment %} <h2>{{ b.avg_rate|floatformat:0 }}</h2>Average Rating {% endcomment %}
                                            {% endif %}
                                            {% endwith %}
                                        </div>
                                       {% comment %} <p> {{ avg }} Stars </p> {% endcomment %}
                                        {% comment %} <span class="review-no">{{ details.reviews }}</span> {% endcomment %}
                                    </div>
                                    <br>

                                    <p >{{ b.description }}.</p>
                                    <p ><strong>Phone</strong>: {{ b.phone }}</p>
                                    <p class="vote"><strong>Address: </strong> {{ b.address }}, {{ b.city }}, {{ b.state }}</p>
                                    {% comment %} <h5 class="sizes">sizes:
                                        <span class="size" data-toggle="tooltip" title="small">s</span>
                                        <span class="size" data-toggle="tooltip" title="medium">m</span>
                                        <span class="size" data-toggle="tooltip" title="large">l</span>
                                        <span class="size" data-toggle="tooltip" title="xtra large">xl</span>
                                    </h5>
                                    <h5 class="colors">colors:
                                        <span class="color orange not-available" data-toggle="tooltip" title="Not In store"></span>
                                        <span class="color green"></span>
                                        <span class="color blue"></span>
                                    </h5> {% endcomment %}
                                    {% comment %} <div class="action">
                                        <form action="details" method="POST">                
                                            {% csrf_token %}
                                        <button class="add-to-cart btn btn-default" type="button" name= "detail" value= "{{ b.id }}" >More Details</button>
                                        </form>
                                        {% comment %} <button class="like btn btn-default" type="button"><span class="fa fa-heart"></span></button> {% endcomment %}
                                    {% comment %} </div>
                                    <div>
                                        </br>
                                        
                                        <div class="mb-3">
                                            <label for="exampleFormControlTextarea1" class="form-label">Please wirte a review for the Business.</label>
                                            
                                            <form action="review" method="POST">                
                                                {% csrf_token %}
                                                                                            
                                                  <div class="mb-3">
                                                    {% for field in form %}
                                                        {{ field.label_tag }}
                                                        {{ field }}
                                                        {{ field.errors }}
                                                  </br>
                                                    {% endfor %}
                                                  
                                                 </div> 
                                                               
                                                <div class="text-center text-lg-start mt-4 pt-2">
                                                    <button type="submit" name= "submit" class="btn btn-primary btn-lg"
                                                        style="padding-left: 2.5rem; padding-right: 2.5rem;" value= "{{ b.id }}" >Add Review</button>
                                                    
                                                </div>
                                            </form> {% endcomment %} 

                                          </div>
                                    </div>
                                </div>

                                <div>
                                    <table class="table table-striped">
                                        <thead>
                                          <tr>
                                            <th scope="col">Rewiews</th>
                                            <th scope="col"> Rating(1-5)</th>
                                            <th scope="col">Date</th>
                                            <th scope="col">User</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                            {% for item in review %}
                                          <tr>
                                            
                                            <td style="word-wrap: break-word;min-width: 160px;max-width: 160px;">{{ item.review }}</td>
                                            <td>{{ item.ratings }}</td>
                                            <td>{{ item.date }}</td>
                                            <td>{{ item.user_id.name }}</td>
                                          </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>



                                </div>

                            </div>
                           
                        
                        </div>
                    </div>
                </div>
            </div>


        

                    
        {% endfor %}

     
    {%else%}
        <h1> Please enter a search item. </h1>
   
    {% endif %}

{% endblock %}